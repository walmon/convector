<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Models | Convector Framework</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet">
	<link rel="stylesheet" href="../assets/css/main.css">
	<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"
	integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.1/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr"
	crossorigin="anonymous">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell"> <a href="../index.html" class="title uppercase">
						<img src="../assets/images/convector.svg" class="convector-logo">
					</a>
				</div>
				<div class="table-cell" id="">
					<div>
						<ul class="social-menu">
							<li>
								<a href="https://discord.gg/twRwpWt" target="_blank">
									<i class="fab fa-discord"></i>
								</a>
							</li>
							<li>
								<a href="https://www.youtube.com/watch?v=snad2K9vu2g&list=PL-1Vd1bTiSr_i2qeqeHCUWaD74ymRvidb" target="_blank">
									<i class="fab fa-youtube"></i>
								</a>
							</li>
							<li>
								<a href="https://twitter.com/convectororg" target="_blank">
									<i class="fab fa-twitter"></i>
								</a>
							</li>
						</ul>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-2 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul class="custom-nav">
					<li>
						<a href="../index.html">
						<i class="fas fa-home"></i>Home</a>
					</li>
					<li>
						<a href="fundamentals.html">Fundamentals</a>
						<ul>
							<li>
								<a href="packages.html">Packages</a>
							</li>
							<li>
								<a href="models.html">Models</a>
							</li>
							<li>
								<a href="controllers.html">Controllers</a>
							</li>
							<li>
								<a href="chaincode_manager.html">Tool: Chaincode Manager</a>
							</li>
							<li>
								<a href="development_environment.html">Tool: Development Environment</a>
							</li>
						</ul>
					</li>
					<li>
						<a href="getting_started.html">Getting Started</a>
						<ul>
							<li>
								<a href="https://medium.com/worldsibu/how-to-create-a-backend-in-nodejs-for-hyperledger-fabric-6c1293fe3e37"
								target="_blank">
								<i class="fas fa-external-link-alt"></i>Fullstack usage - Node JS integration</a>
							</li>
						</ul>
					</li>
					<li>
						<a href="tips.html">Tips and tricks</a>
					</li>
					<li>
						<a href="linux_users.html">For Linux Users</a>
					</li>
					<li>
						<a href="hyperledger_fabric.html">Small overview of Hyperledger Fabric</a>
					</li>
					<li>
						<a href="https://github.com/worldsibu/hurley" target="_blank">
							<i class="fas fa-tools"></i>
						Hurley</a>
					</li>
					<li>
						<a href="https://github.com/worldsibu/convector-cli" target="_blank">
							<i class="fas fa-terminal"></i>
						Convector CLI</a>
					</li>
					<li>
						<a href="https://github.com/worldsibu/convector" target="_blank">
							<i class="fab fa-github"></i>
						Source code</a>
					</li>
					<li>
						<a href="https://medium.com/worldsibu/for-devs/home" target="_blank">
						<i class="fab fa-medium-m"></i>Medium Blog</a>
					</li>
					<li>
						<a href="https://discord.gg/twRwpWt" target="_blank"><i class="fab fa-discord"></i> Discord chat</a>
					</li>
					<li>
						<div class="powered-by">
							<div>Created and sponsored by
								<a href="https://worldsibu.tech">
									<img src="../assets/images/worldsibu.svg" width=150>
							</a></div>
							<div>
								Licensed under the
								<a href="https://raw.githubusercontent.com/worldsibu/convector/develop/LICENSE.txt" target="_blank">Apache 2.0
								license</a>.
							</div>
						</div>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
		<div class="col-10 col-content">
			<div class="tsd-page-title">
				<div class="container-fluid">
					<ul class="tsd-breadcrumb">
						<li>
							<a href="../index.html"> Convector Suite</a>
						</li>
					</ul>
					<h1>Models</h1>
				</div>
			</div>
			<div>
				<section class="tsd-panel tsd-comment">
					<div class="tsd-comment tsd-typography">
						<div class="lead">
							<!-- # Guides

- <a href="fundamentals.html">Fundamentals</a>
- <a href="getting_started.html">Getting-Started</a> -->
							<h1 id="models">Models</h1>
							<p>We define models as assets you interact with in a blockchain
							Every data structure should be a model, since it defines what are the minimum necessary properties to be present.</p>
							<p>The package <code>@worldsibu/convector-core-model</code> contains the necessary code to create models. Here&#39;s an example of one:</p>
							<pre><code class="lang-typescript"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> yup <span class="hljs-keyword">from</span> <span class="hljs-string">'yup'</span>;
<span class="hljs-keyword">import</span> {
  ConvectorModel, ReadOnly, Required, Validate
} <span class="hljs-keyword">from</span> <span class="hljs-string">'@worldsibu/convector-core-model'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> ExampleModel <span class="hljs-keyword">extends</span> ConvectorModel&lt;ExampleModel&gt; {
  <span class="hljs-meta">@ReadOnly</span>()
  <span class="hljs-meta">@Validate</span>(yup.string())
  <span class="hljs-keyword">public</span> readonly <span class="hljs-keyword">type</span> = <span class="hljs-string">'io.worldsibu.examples.example-model'</span>;

  <span class="hljs-meta">@Required</span>()
  <span class="hljs-meta">@Validate</span>(yup.string())
  <span class="hljs-keyword">public</span> name: <span class="hljs-built_in">string</span>;

  <span class="hljs-meta">@Required</span>()
  <span class="hljs-meta">@Validate</span>(yup.number())
  <span class="hljs-meta">@Default</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">Date</span>.now())
  <span class="hljs-keyword">public</span> updated: <span class="hljs-built_in">number</span>;
}
</code></pre>
							<p>Notice we&#39;re extending <code>ConvectorModel</code>. This class is full of rich methods you can use to manipulate the data.</p>
							<p>There are multiple decorators you can use to model the data:</p>
							<ul>
								<li><code>@ReadOnly()</code> - used when you want a property to be set once and then sealed to modifications</li>
								<li><code>@Required()</code> - used when you want the property to be ensured there will be a value</li>
								<li><code>@Default(val | () =&gt; val)</code> - used when you want to provide a default value before saving the data to the blockchain if there was no value provided</li>
								<li><code>@Required(Schema|Model)</code> - used to validate the property to conform a format</li>
							</ul>
							<h2 id="usage">Usage</h2>
							<p>To simply create a base model file through <a href="https://github.com/worldsibu/convector-cli" target="_blank">Convector CLI</a> run.</p>
							<pre><code class="lang-bash">conv generate model &lt;NAME-OF-MODEL&gt;
</code></pre>
							<p>Then you can edit it and adapt it as you need.</p>
							<h3 id="more-advanced">More advanced</h3>
							<p>The children classes can be used in 1 of 3 ways:</p>
							<h3 id="1-as-an-model-query">1. As an model query</h3>
							<pre><code class="lang-ts"><span class="hljs-keyword">class</span> MyModel <span class="hljs-keyword">extends</span> ConvectorModel&lt;MyModel&gt; { ... }

<span class="hljs-keyword">const</span> model = <span class="hljs-keyword">new</span> MyModel(id);
model.fetch()
  .then(onModelFound)
  .catch(onModelNotFound);
</code></pre>
							<p>or</p>
							<pre><code class="lang-ts"><span class="hljs-keyword">class</span> MyModel <span class="hljs-keyword">extends</span> ConvectorModel&lt;MyModel&gt; { ... }

MyModel.getOne(id)
  .then(onModelFound);
</code></pre>
							<h3 id="2-as-a-param-constructor-and-validator">2. As a param constructor and validator</h3>
							<pre><code class="lang-ts"><span class="hljs-keyword">class</span> MyModel <span class="hljs-keyword">extends</span> ConvectorModel&lt;MyModel&gt; { <span class="hljs-comment">/* ... */</span> }

<span class="hljs-meta">@Controller</span>(<span class="hljs-string">'my-controller'</span>)
<span class="hljs-keyword">class</span> MyController {
  <span class="hljs-meta">@Invokable</span>()
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> myMethod(
    <span class="hljs-meta">@Param</span>(MyModel)
    myModel: MyModel
  ) {
    myModel.save();
  }
}
</code></pre>
							<h3 id="3-as-a-container-to-start-filling-the-model">3. As a container to start filling the model</h3>
							<pre><code class="lang-ts"><span class="hljs-keyword">class</span> MyModel <span class="hljs-keyword">extends</span> ConvectorModel&lt;MyModel&gt; { <span class="hljs-comment">/* ... */</span> }

<span class="hljs-keyword">const</span> myModel = <span class="hljs-keyword">new</span> MyModel();
myModel.name = <span class="hljs-string">'name'</span>;
myModel.info = <span class="hljs-string">'info'</span>;
<span class="hljs-comment">/* ... */</span>
myModel.save();
</code></pre>
							<h2 id="api">API</h2>
							<p>Models are based on <code>ConvectorModel&lt;T&gt;</code>, and it provides some basic <em>static</em> methods to use on models.</p>
							<h3 id="querying-the-chaincode">Querying the chaincode</h3>
							<p>Some static methods are present for you to query the chaincode storage. All these methods are subject to the <code>storage</code> capabilities, for example, using <code>storage-couchdb</code> you will be able to query the database in a more fashin way, even using views or similar.</p>
							<pre><code class="lang-typescript"><span class="hljs-comment">// Get one of the models based on the ID</span>
MyModel.getOne(id).then(onModelFound);

<span class="hljs-comment">// Get all the elements based on the `type` field</span>
MyModel.getAll(<span class="hljs-string">'io.worldsibu.models.test'</span>).then(onModelsFound);

<span class="hljs-comment">// Complex queries, depending on the `convector-storage` in use</span>
MyModel.query({ amount: { $lte: <span class="hljs-number">5</span> } }).then(onModelsFound);
</code></pre>
							<h3 id="basic-properties">Basic properties</h3>
							<p>All models are required to have an <code>id</code> and a <code>type</code> field. The declaration of both can be omitted if wanted, but both of them must have a value. If you pass a string as the only param while instantiating a model, it will be used as the ID of that model.</p>
							<h3 id="base-methods">Base methods</h3>
							<ul>
								<li>To fetch the model content from the ledger and load the data into a model use <code>async myModel.fetch()</code>, the ID must have been set before this</li>
								<li>To create or update a whole model in the blockchain you mut use <code>async myModel.save()</code></li>
								<li>To update a portion of an existing model in the blockchain you must use <code>async myModel.update({ changes })</code></li>
								<li>To delete the model content in the blockchain you must use <code>async myModel.delete()</code> however, notice that a delete in blockchain terms, is just removing the current value from the state, but the historical data will still be there and cannot be removed</li>
								<li>To clone a model you can use <code>myModel.clone()</code></li>
								<li>To convert a model to json you can do <code>JSON.stringify(myModel)</code> or <code>myModel.toJSON()</code></li>
							</ul>
							<hr>
							<p><a href="https://github.com/worldsibu/convector-cli" target="_blank">Convector CLI</a> has been recently released! Get familiar with the new way to create Enterprise Smart Contract Systems.</p>
							<p><a href="https://github.com/worldsibu/convector/issues"><img src="https://img.shields.io/github/issues-raw/@worldsibu/convector.svg" alt="Issues"></a>
								<a href="https://worldsibu.io/subscribe/"><img src="https://img.shields.io/badge/Newsletter--orange.svg" alt="Newsletter"></a>
							<a href="https://discord.gg/twRwpWt"><img src="https://img.shields.io/discord/469152206638284800.svg" alt="Discord"></a></p>
							<p><a href="https://www.npmjs.com/package/@worldsibu/convector-core-chaincode"><img src="https://img.shields.io/npm/v/@worldsibu/convector-core-chaincode.svg" alt="npm"></a>
							<a href="https://opensource.org/licenses/Apache-2.0"><img src="https://img.shields.io/badge/License-Apache%202.0-blue.svg" alt="License"></a></p>
							<p><a class="github-button" href="https://github.com/worldsibu/convector" data-icon="octicon-star" data-size="large" aria-label="Star worldsibu/convector on GitHub">Star</a> <a class="github-button" href="https://github.com/worldsibu" data-size="large" aria-label="Follow @worldsibu on GitHub">Follow</a></p>
							<script async defer src="https://buttons.github.io/buttons.js"></script>
						</div>
					</div>
				</section>
			</div>
		</div>
	</div>
</div>
<footer  class="with-border-bottom" >
	<div class="container tsd-generator">
		<div class="double-content">
			<div>
				<a href="https://worldsibu.tech">
					<img src="../assets/images/worldsibu.svg" width=200>
				</a>
			</div>
			<div>
				<!-- Begin Mailchimp Signup Form -->
				<link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css">
				<style type="text/css">
          .middle {
            color: #fff !important;

          }

          .footer #mc_embed_signup {
            background: transparent;
            clear: left;
            font: 16px Helvetica, Arial, sans-serif;
            width: 100%;
          }

          /* Add your own Mailchimp form style overrides in your site stylesheet or in this style block.
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
        </style>
				<style type="text/css">
          .middle #mc-embedded-subscribe {
            background: #F40257;
            text-transform: uppercase;
            padding: 0px 24px !important;
            height: auto;
            border-radius: 50px !important;
            font-size: 14px !important;
          }

          .middle #mc-embedded-subscribe:hover {
            background: #F40257 !important;
          }

          .middle #mc-embedded-subscribe-form input[type=checkbox] {
            display: inline;
            width: auto;
            margin-right: 10px;
            text-align: left !important;
          }

          .middle #mergeRow-gdpr {
            margin-top: 20px;
            text-align: left !important;
          }

          .middle #mergeRow-gdpr fieldset label {
            font-weight: normal;
            text-align: left !important;
          }

          .middle #mc-embedded-subscribe-form .mc_fieldset {
            border: none;
            min-height: 0px;
            padding-bottom: 0px;
            border-radius: 50px;
            text-align: left !important;
            font-size: 20px !important;
          }

          .middle #mc_embed_signup_scroll {}

          .middle #mce-EMAIL {
            width: 300px !important;
            font-size: 14px !important;
          }
        </style>
				<div class="middle">
					<div id="mc_embed_signup">
						<form action="https://worldsibu.us19.list-manage.com/subscribe/post?u=4a9f0fa5a8269abdb50f5881a&amp;id=3aec9b46df"
						method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank"
						novalidate>
						<div id="mc_embed_signup_scroll">
							<input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="Your email"
							required>
							<!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
							<div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_4a9f0fa5a8269abdb50f5881a_3aec9b46df"
							tabindex="-1" value=""></div>
							<div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe"
							class="button"></div>
						</div>
						</form>
					</div>
				</div>
				<!--End mc_embed_signup-->
			</div>
		</div>
	</div>
</footer>
<div class="overlay"></div>
<script src="../assets/js/main.js"></script>
<script>if (location.protocol == 'file:') document.write('<script src="../assets/js/search.js"><' + '/script>');</script>
<script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-128943824-2', '');
        ga('send', 'pageview');
    </script>
</body>
</html>